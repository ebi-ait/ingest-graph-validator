## Test: Processes using smartseq2 library preparation protocols have no more than one sequence file per read type

#### Test description

Processes using smartseq2 library preparation protocols have no more than one sequence file per read type.



#### The test
[source,cypher]
----
MATCH (r:library_preparation_protocol)<-[:PROTOCOLS]-(p:process)<-[d]-(f:sequence_file)
OPTIONAL MATCH (p)-[]-(s:sequencing_protocol)
WITH r, p, s, COUNT(f.`read_index`) as num_files, COUNT(DISTINCT f.`read_index`) as read_set
WHERE r.`library_construction_method.ontology` = "EFO:0008931" // SmartSeq2
AND s.`paired_end`
AND NOT num_files = read_set
RETURN p, "Smart-Seq2 process should have at most 1 file per type of read", labels(p)
----
